---
title: "WORKING WITH DATABASES MýQL"
output: html_notebook
Edit: Ms Nguyen Xuan Huy - FPTU HCM
---

## Demo: Kết nối CSDL và tạo 1 bảng

1.  Kết nối đến cơ sở dữ liệu.

2.  Tạo bảng mới với các cột và khóa chính/phụ cần thiết.

3.  Thêm dữ liệu vào bảng.

    ## Kiểm tra dữ liệu đã thêm.

#1. kết nối đến cơ sở dữ liệu MySQL chạy trên XAMPP

## Cài đặt packages:

```{r}
install.packages("DBI")

```

```{r}
install.packages("RMySQL")

```

```{r}
install.packages("RMariaDB")
```

## cập nhật library

```{r}
library(DBI)
```

```{r}
library(RMySQL)
```

```{r}
library(RMariaDB)
```

## Thiết lập thông tin kết nối đến server

```{r}
# Thiết lập thông tin kết nối
host <- "127.0.0.1"  # hoặc "localhost"
port <- 3306         # cổng mặc định của MySQL
dbname <- "fpt_demo"
user <- "user_mobile"
password <- "abc123admin"
```

```{r}
# Tạo kết nối tới cơ sở dữ liệu
con <- dbConnect(RMySQL::MySQL(),
                 host = host,
                 port = port,
                 dbname = dbname,
                 user = user,
                 password = password)
```

```{r}
# Tạo kết nối đến cơ sở dữ liệu
conn <- tryCatch({
  dbConnect(RMariaDB::MariaDB(),
            dbname = dbname,
            host = host,
            port = port,
            user = user,
            password = password)
}, error = function(e) {
  stop("Không thể kết nối đến cơ sở dữ liệu: ", e$message)
})

# Kiểm tra kết nối
if (!dbIsValid(conn)) {
  stop("Không thể kết nối đến cơ sở dữ liệu")
} else {
  print("Kết nối thành công")
}
```

-   Sử dụng hàm dbExecute để thực thi câu lệnh SQL tạo bảng mới và thêm dữ liệu vào bảng.
-   khai báo cột khóa chính và cột khóa phụ:

```{r}
# Tạo bảng nhân viên
dbExecute(conn, "
  CREATE TABLE employee (
    SupportRepId INT NOT NULL AUTO_INCREMENT,
    FirstName VARCHAR(255),
    LastName VARCHAR(255),
    Department VARCHAR(255),
    Phone VARCHAR(20),
    Email VARCHAR(255),
    PRIMARY KEY (SupportRepId)
  )
")

print("Tạo bảng nhân viên thành công")
```

```{r}
# Thêm dữ liệu vào bảng
dbExecute(conn, "
  INSERT INTO employee (SupportRepId, FirstName, LastName, Department, Phone, Email)
  VALUES
  (1, 'Triệu Văn', 'QUang', 'Kinh doanh', '07856643a435', 'quang@gmail.com'),
  (2, 'Nguyễn Việt', 'Thnah', 'Mảketing', '044457224872', 'thanh@gmail.com'),
  (3, 'Trân Thanh', 'Tài', 'Sale', '094a7845454', 'tài@gmail.com'),
  (4, 'Quản văn', 'Binh', 'Tư vấn', '0872312312121', 'hai@gmail.com'),
  (5, 'Vũ văn', 'Hải', 'Giám đốc', '07213242 54', 'hoa@gmail.com')
")

print("Thêm dữ liệu vào bảng nhân viên thành công")
```
